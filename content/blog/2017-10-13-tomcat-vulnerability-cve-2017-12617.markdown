---
layout: post
title: "Tomcat vulnerability CVE-2017-12617"
date: "2017-10-13 12:00"
author: 'u-ryo'
categories: [tomcat, vulnerability, security, poc]
comments: true
published: true
---
[Tomcatの複数の脆弱性(CVE-2017-12617, CVE-2017-12615 , CVE-2017-12616)](https://oss.sios.com/security/tomcat-security-vulnerabiltiy-20170920)が、範囲が広がって出てました。
`readonly initialization parameter`を`false`にして`PUT`を有効化している時にaffectする(任意のjsp fileを不正に`PUT`してから好き放題する)、とのことなので、きょうびはRESTで`PUT`多用するから影響範囲広いんでしょうか? 否、「default servletのinitialization parameter(具体的には`web.xml`の`servlet`tagの`init-param`)で`false`を明示した時(defaultは`true`)なので、殆どのところはそんなことしてないから大丈夫なんじゃないでしょうか。
実際、[POC](https://github.com/cyberheartmi9/CVE-2017-12617)で試してみたところ、うちのsiteは(version的には範囲内ですが)`Not Vulnerable to CVE-2017-12617`と出ました。
```
$ python tomcat-cve-2017-12617.py -u http://localhost:8080



   _______      ________    ___   ___  __ ______     __ ___   __ __ ______ 
  / ____\ \    / /  ____|  |__ \ / _ \/_ |____  |   /_ |__ \ / //_ |____  |
 | |     \ \  / /| |__ ______ ) | | | || |   / /_____| |  ) / /_ | |   / /
 | |      \ \/ / |  __|______/ /| | | || |  / /______| | / / '_ \| |  / /
 | |____   \  /  | |____    / /_| |_| || | / /       | |/ /| (_) | | / /
  \_____|   \/   |______|  |____|\___/ |_|/_/        |_|____\___/|_|/_/


[@intx0x80]


Poc Filename  Poc.jsp
Not Vulnerable to CVE-2017-12617
```
